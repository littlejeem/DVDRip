# file goes here:
# /etc/udev/rules.d/DetermineMediaType
# credit goes to here:
# http://confoundedtech.blogspot.co.uk/2012/12/ubuntu-1204-run-custom-command-on-cd.html
#
#
# Code
#
#!/bin/bash
#This script is call by udev on cd detection to run the CDRip script under the X session of the main user

#Remove the old log from the previous run
rm DetermineMediaType.log

#Check for CD presence
if [ "$ID_CDROM_MEDIA_CD" == "" ]
then
 false
 echo "No CD detected" >> /etc/udev/rules.d/DetermineMediaType.log
else
 #Check whether CD is a media CD
 if [ $ID_CDROM_MEDIA_CD == "1" ]
 then
  true # This is True for a CD Audio. Data disk?
  echo "CD ripping started" >> /etc/udev/rules.d/DetermineMediaType.log
  
  #Call CD Rip script in the user x environment
  set -x
  xhost local:USERNAME
  export DISPLAY=:0.0
  #At last Run the custom CD script
  su USERNAME -c "/home/USERNAME/Desktop/CDRip"

 fi
fi

#Check for DVD presence
#ID_CDROM_MEDIA_DVD=1
if [ "$ID_CDROM_MEDIA_DVD" == "" ]
then
 false
        echo "No DVD detected" >> /etc/udev/rules.d/DetermineMediaType.log
else
 #Check whether DVD is a media DVD
 if [ $ID_CDROM_MEDIA_DVD == "1" ]
 then
  true # This is True for a DVD Video. Data disk?
  echo "DVD detected" >> /etc/udev/rules.d/DetermineMediaType.log
 fi
fi
exit 0
